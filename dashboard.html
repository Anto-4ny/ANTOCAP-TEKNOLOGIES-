<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sanfiat Technologies - My Dashboard</title>
    <meta name="description" content="Sanfiat Technologies offers top-notch products and services advertising.">
    <meta property="og:title" content="Sanfiat Technologies">
    <meta property="og:description" content="Leading provider of products and services advertisment.">
    <meta property="og:image" content=images/Photo_1723191951676.png">
    <meta property="og:url" content="https://www.sanfiat-technologies.com">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dashboard.css">
    <link rel="icon" href="images/Photo_1723191951676.png" type="image/x-icon">
    <style>
        /* Basic styling, adjust as needed */
        .hidden { display: none; }
        .show { display: block; }
        .password-toggle { cursor: pointer; }
        #payment-section { margin-top: 20px; }
        .message { color: red; }
    </style>
</head>
    <header>
    <a href="index.html">
        <img id="logo" src="images/Photo_1723191951676.png" alt="Logo">
    </a>
    <button id="hamburger-icon" class="hamburger-menu">
        <img src="images/hamburger.png" alt="Menu Icon">
    </button>
    <nav class="desktop-nav">
        <a href="#home">Home</a>
        <a href="#register">Register</a>
        <a href="#login">Log in</a>
        <a href="#dashboard">Dashboard</a>
        <a href="#packages">Packages</a>
    </nav>
    <nav id="mobile-nav" class="mobile-nav">
        <a href="#home">Home</a>
        <a href="#register">Register</a>
        <a href="#login">Log in</a>
        <a href="#dashboard">Dashboard</a>
        <a href="#packages">Packages</a>
    </nav>
    </header>

<section id="dashboard">
            <div id="dashboard-section">
                <h2>Your Dashboard</h2>
                <section class="dashboard-welcome-box">
                    <h1>Welcome back <span id=" firstName"></span> to Your Dashboard</h1>
                    <p>To start uploading screenshots of your WhatsApp status views and track your earnings, you need to refer at least 10 people. Each referred person must pay the registration fee to be eligible. Once you have 10 referrals, a product will be sent to you every day and you will be required to post it on your WhatsApp status and submit views after 24 hours. It will then be reviewed and feedback sent after some time. Enjoy earning from your status views.</p>
                </section>
                
                <div id="user-info">
                    <div class="info-box">
                        <p>Email: <span id="user-email"></span></p>
                    </div>
                    <div class="info-box">
                        <p>Referrals: <span id="referral-count"></span></p>
                    </div>
                    <div class="info-box">
                        <p>Total Views: <span id="total-views"></span></p>
                    </div>
                    <div class="info-box">
                        <p>Total Earnings: <span id="total-earnings"></span> Ksh</p>
                    </div>
                    <div class="info-box">
                        <p>Amount Paid: <span id="amount-paid">0</span> Ksh</p>
                    </div>
                </div>
<!-- Payment Section -->
    <div id="payment-section" class="payment-box">
        <h3>Make a Payment</h3>
        <img src="https://www.safaricom.co.ke/images/mpesa-logo.png" alt="MPESA Logo" class="mpesa-image">
        <p>To complete your payment via MPESA, follow the steps below:</p>
        <ol>
            <li>Enter your phone number in the field provided below.</li>
            <li>Click the "Pay 250 Ksh" button.</li>
            <li>A pop-up message will appear on your phone from MPESA, prompting you to enter your MPESA PIN.</li>
            <li>After entering your MPESA PIN, you will receive a confirmation message with your transaction code.</li>
            <li>Copy the MPESA transaction code and paste it in the field labeled "Enter MPESA Code" below.</li>
            <li>Submit your transaction code and wait for up to 30 minutes for confirmation.</li>
        </ol>

        <label for="phone-number">Enter Your Phone Number:</label>
        <input type="text" id="phone-number" placeholder="07XX XXX XXX">
        
        <button type="button" id="pay-button">Pay 250 Ksh</button>
        
        <label for="payment-confirmation">Enter MPESA Code:</label>
        <input type="text" id="payment-confirmation" placeholder="MPESA Transaction Code">
        
        <button type="button" id="submit-payment">Submit Payment Code</button>

        <p id="payment-status"></p>
    </div>

    <!-- Confirmation Section -->
    <div id="confirmation-section" class="confirmation-box">
        <h3>Business Payment Details</h3>
        <p><strong>Business Number:</strong> 400200</p>
        <p><strong>Account Number:</strong> 860211</p>

        <label for="confirm-mpesa-code">Enter MPESA Code:</label>
        <input type="text" id="confirm-mpesa-code" placeholder="MPESA Transaction Code">

        <button type="button" id="submit-confirmation">Submit Payment Code</button>
    </div>
                
</div>
<section id="upload-section">
                    <h2>Upload Your Status Screenshot</h2>
                    <form id="upload-form">
                        <label for="views">Number of Views:</label>
                        <input type="number" id="views" placeholder="Enter number of views" required>
                        
                        <label for="screenshot">Screenshot:</label>
                        <div class="upload-container">
                            <div id="drop-zone" class="drop-zone" aria-label="Drop files here or click to upload">
                                <p>Drag and drop files here or click to upload.</p>
                                <input type="file" id="file-input" accept="image/*" aria-label="Choose screenshot" required />
                            </div>
                            <div id="file-preview" class="file-preview">
                                <!-- Preview of selected files will be shown here -->
                            </div>
                        </div>
                        <button type="submit" id="upload-button" aria-label="Upload screenshot">Upload Screenshot</button>
                    </form>
                </section>
                
                <div id="referral-link-section">
                    <h3>Your Referral Link</h3>
                    <p id="referral-link"></p>
                    <button id="copy-link-button">Copy Link</button>
                    <a id="whatsapp-share-button" href="#" target="_blank" aria-label="Share on WhatsApp">
                        <img src="images/waicon.jpg" alt="Share on WhatsApp" style="width: 30px; vertical-align: middle;">
                        Share on WhatsApp
                    </a>
                </div>
            </div>
<footer>
    <div class="footer">
    <div class="footer-item">
        <a href="#home">
            <img src="images/home.png" alt="Home Icon" class="footer-icon">
            <span>Home</span>
        </a>
    </div>
    <div class="footer-item">
        <a href="#login">
            <img src="images/images.png" alt="Login Icon" class="footer-icon">
            <span>Log in</span>
        </a>
    </div>
    <div class="footer-item">
        <a href="#register">
            <img src="images/images.jpeg" alt="Register Icon" class="footer-icon">
            <span>Register</span>
        </a>
    </div>
    <div class="footer-item">
        <a href="dashboard.html">
            <img src="images/dashboard .png" alt="Dashboard Icon" class="footer-icon">
            <span>Dashboard</span>
        </a>
    </div>
    <div class="footer-item">
        <a href="#packages">
            <img src="images/packages.png" alt="Packages Icon" class="footer-icon">
            <span>Packages</span>
        </a>
    </div>
    </div>
    
    <div class="Button">
        <a href="#dashboard">
            <p class="post-btn">
                <i class="fa fa-plus-square"></i>
            </p>
        </a>
    </div>
</footer>
    
        <p class="copyright-text">&copy; 2024 Sanfiat Technologies. All rights reserved.</p>
<script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-storage.js"></script>
    
<script>
    // Handle Pay button click
document.getElementById("pay-button").addEventListener("click", function() {
    const phoneNumber = document.getElementById("phone-number").value;
    
    if (phoneNumber.length === 10) {
        // Simulate MPESA payment process
        alert(`An MPESA pop-up will appear on phone number ${phoneNumber}. Please enter your MPESA PIN.`);
        
        // Add initial payment status to Firestore as pending
        db.collection("payments").add({
            phoneNumber: phoneNumber,
            amount: 250,
            status: "Pending",
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        }).then(function(docRef) {
            console.log("Payment added with ID: ", docRef.id);
            alert("After receiving the MPESA transaction code, please enter it in the next field.");
        }).catch(function(error) {
            console.error("Error adding payment: ", error);
        });
    } else {
        alert("Please enter a valid phone number.");
    }
});

// Handle payment code submission
document.getElementById("submit-payment").addEventListener("click", function() {
    const paymentCode = document.getElementById("payment-confirmation").value;
    
    if (paymentCode) {
        // Update Firestore with the MPESA transaction code
        db.collection("payments").where("phoneNumber", "==", document.getElementById("phone-number").value)
        .get().then((querySnapshot) => {
            querySnapshot.forEach((doc) => {
                db.collection("payments").doc(doc.id).update({
                    mpesaCode: paymentCode,
                    status: "Waiting for Confirmation"
                });
                document.getElementById("payment-status").textContent = "Payment submitted. Please wait up to 30 minutes for confirmation.";
            });
        }).catch((error) => {
            console.error("Error updating payment: ", error);
        });
    } else {
        alert("Please enter the MPESA transaction code.");
    }
});
</script>
    <!-- Your custom script using Firebase -->
    <script type="module" src="script.js"></script>
</body>
</html>
